// NGP_IQ.c
// Generated by decompiling NGP_IQ.NGP
// using Reko decompiler version 0.8.2.0.

#include "NGP_IQ.h"

// 00200089: void fn00200089(Register word16 de)
void fn00200089(word16 de)
{
	fn0020060C();
	*(byte *) 0x6F86 |= 0x40;
	word32 * xiy_n = (word32 *) 28600;
	byte b_n;
	for (b_n = 0x12; b_n != 0x00; --b_n)
	{
		*xiy_n = globals->dw200040;
		++xiy_n;
	}
	*(byte *) 0x8002 = 0x00;
	*(byte *) 0x8003 = 0x00;
	*(byte *) 0x8004 = 0xA0;
	*(byte *) 0x8005 = 0x98;
	word16 * xhl_n = (word16 *) 0xA000;
	word16 bc_n;
	for (bc_n = 0x0200; bc_n != 0x00; --bc_n)
	{
		*xhl_n = 0x00;
		++xhl_n;
	}
	word16 bc_n;
	word16 * xde_n = (word16 *) 0xA400;
	word16 * xhl_n = globals->a20061D;
	for (bc_n = 0x0250; bc_n != 0x00; --bc_n)
	{
		*xde_n = *xhl_n;
		++xhl_n;
		++xde_n;
	}
	fn002005B8();
	__ei(0x00);
	word16 bc_n;
	word16 * xde_n = (word16 *) 0x8300;
	word16 * xhl_n = globals->a200ABD;
	for (bc_n = 0x10; bc_n != 0x00; --bc_n)
	{
		*xde_n = *xhl_n;
		++xhl_n;
		++xde_n;
	}
	*(byte *) 0x83E0 = 0x33;
	*(byte *) 33761 = 0x07;
	*(byte *) 0x8118 = 0x80;
	word16 wa_n = fn00200557(0x00, DPB(bc_n, 0x00, 8), 0x04, &globals->b2000FD);
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x01, 8), 0x04, &globals->b200122);
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x04, 8), 0x04, &globals->b200147);
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x05, 8), 0x02, &globals->b200165);
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x06, 8), 0x02, &globals->b20017F);
	byte * xde_n = (byte *) 0x7000;
	byte * xhl_n = globals->a200363;
	word16 bc_n;
	for (bc_n = 303; bc_n != 0x00; --bc_n)
	{
		*xde_n = *xhl_n;
		++xhl_n;
		++xde_n;
	}
	word16 wa_n;
	word16 bc_n;
	fn002004F2(0x01);
	word32 xsp_n;
	word32 xix_n;
	word32 xiy_n;
	byte b_n;
	word32 xwa_n;
	word16 wa_n;
	word32 xhl_n;
	word16 bc_n;
	word32 xde_n;
	bool H_n;
	bool V_n;
	bool N_n;
	byte d_n;
	byte c_n;
	byte w_n;
	word16 hl_n;
	byte a_n;
	byte SZHVC_n;
	bool Z_n;
	word16 de_n;
	(*(union Eq_n *) 0x7000)();
	fn00200532(0x04, bc_n, fn00200532(*(byte *) 0x4003, bc_n, de_n, 3334), 3333);
	word16 wa_n = DPB(wa_n, 0x04, 8);
	if (*(byte *) 0x4003 == 0x04)
	{
		bc_n = DPB(bc_n, 0x04, 8);
		wa_n = fn00200557(wa_n, bc_n, 0x01, &globals->b2001D2);
	}
	else
	{
		bc_n = DPB(bc_n, 0x04, 8);
		wa_n = fn00200557(wa_n, bc_n, 0x03, &globals->b2001E8);
	}
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x08, 8), 0x04, &globals->b2001FD);
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x09, 8), 0x02, &globals->b200217);
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x0A, 8), 0x02, &globals->b200231);
	byte * xde_n = (byte *) 0x7000;
	byte * xhl_n = globals->a200492;
	word16 bc_n;
	for (bc_n = 0x23; bc_n != 0x00; --bc_n)
	{
		*xde_n = *xhl_n;
		++xhl_n;
		++xde_n;
	}
	word16 wa_n;
	word16 bc_n;
	fn002004F2(0x01);
	word32 xsp_n;
	word32 xix_n;
	word32 xiy_n;
	byte b_n;
	word32 xwa_n;
	word16 wa_n;
	word32 xhl_n;
	word16 bc_n;
	word32 xde_n;
	bool H_n;
	bool V_n;
	bool N_n;
	byte d_n;
	byte c_n;
	byte w_n;
	word16 hl_n;
	byte a_n;
	byte SZHVC_n;
	bool Z_n;
	word16 de_n;
	(*(union Eq_n *) 0x7000)();
	fn00200532(0x01, bc_n, fn00200532(*(byte *) 0x4003, bc_n, de_n, 3338), 3337);
	word16 wa_n = DPB(wa_n, 0x04, 8);
	if (*(byte *) 0x4003 == 0x01)
	{
		bc_n = DPB(bc_n, 0x08, 8);
		wa_n = fn00200557(wa_n, bc_n, 0x01, &globals->b200284);
	}
	else
	{
		bc_n = DPB(bc_n, 0x08, 8);
		wa_n = fn00200557(wa_n, bc_n, 0x03, &globals->b20029A);
	}
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x0C, 8), 0x04, &globals->b2002AF);
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x0D, 8), 0x02, &globals->b2002CB);
	word16 wa_n = fn00200557(wa_n, DPB(bc_n, 0x0E, 8), 0x02, &globals->b2002E5);
	byte * xde_n = (byte *) 0x7000;
	byte * xhl_n = globals->a2004B5;
	word16 bc_n;
	for (bc_n = 0x2B; bc_n != 0x00; --bc_n)
	{
		*xde_n = *xhl_n;
		++xhl_n;
		++xde_n;
	}
	fn002004F2(0x01);
	word32 xsp_n;
	word32 xix_n;
	word32 xiy_n;
	byte b_n;
	word32 xwa_n;
	word16 wa_n;
	word32 xhl_n;
	word16 bc_n;
	word32 xde_n;
	bool H_n;
	bool V_n;
	bool N_n;
	byte d_n;
	byte c_n;
	byte w_n;
	word16 hl_n;
	byte a_n;
	byte SZHVC_n;
	bool Z_n;
	word16 de_n;
	(*(union Eq_n *) 0x7000)();
	fn00200532(0x00, bc_n, fn00200532(*(byte *) 0x4003, bc_n, de_n, 0x0D0E), 0x0D0D);
	word16 wa_n = DPB(wa_n, 0x04, 8);
	if (*(byte *) 0x4003 == 0x00)
		fn00200557(wa_n, DPB(bc_n, 0x0C, 8), 0x01, &globals->b200338);
	else
		fn00200557(wa_n, DPB(bc_n, 0x0C, 8), 0x03, &globals->b20034E);
	while (true)
		;
}

// 002004F2: void fn002004F2(Register byte w)
void fn002004F2(byte w)
{
	*(byte *) 0x4004 = 0x00;
	do
		;
	while (*(byte *) 0x4004 != w);
}

// 0020050A: Register byte fn0020050A(Register word16 bc, Register word16 de, Register word16 hl, Register out Eq_n deOut, Register out Eq_n hOut)
byte fn0020050A(word16 bc, word16 de, word16 hl, Eq_n & deOut, Eq_n & hOut)
{
	word16 de_n;
	*deOut = (word16) xde;
	byte h_n;
	*hOut = SLICE(xhl, byte, 8);
	return (byte) xbc;
}

// 00200532: Register word16 fn00200532(Register byte a, Register word16 bc, Register word16 de, Register word16 hl)
word16 fn00200532(byte a, word16 bc, word16 de, word16 hl)
{
	word16 de_n;
	byte h_n;
	word16 bc_n = DPB(bc, fn0020050A(DPB(bc, a, 0), de, hl, out de_n, out h_n), 0);
	word16 de_n;
	byte h_n;
	fn0020050A(bc_n, de_n, DPB(hl, h_n + 0x01, 8), out de_n, out h_n);
	return de_n;
}

// 00200557: Register word16 fn00200557(Register word16 wa, Register word16 bc, Register byte d, Register (ptr32 byte) xhl)
word16 fn00200557(word16 wa, word16 bc, byte d, byte * xhl)
{
	word16 wa_n = DPB(wa, c * 0x02, 0);
	word32 * xde_n = (word16) (DPB(bc, 0x00, 8) * 0x40) + ((word32) (c * 0x02) + 0x9800) + 0x01;
	byte b_n;
	for (b_n = 0x13; b_n != 0x00; --b_n)
	{
		cu8 v17_n = *xhl;
		wa_n = DPB(wa_n, v17_n, 0);
		if (v17_n == 0x00)
			return wa_n;
		++xhl;
		if (v17_n >= 0x5B)
			wa_n = DPB(wa_n, v17_n + 0xE0, 0);
		word32 * xde_n = xde_n;
		wa_n = DPB(DPB(wa_n, 0x00, 8) + 0x09, *xde_n, 8);
		xde_n = (word32 *) ((char *) xde_n + 0x01);
	}
	return wa_n;
}

// 002005B8: void fn002005B8()
void fn002005B8()
{
	byte * xbc_n = (byte *) 0x9000;
	word16 hl_n;
	for (hl_n = 0x04C0; hl_n != 0x00; --hl_n)
	{
		*xbc_n = 0x00;
		++xbc_n;
	}
	byte * xbc_n = (byte *) 0x9800;
	word16 hl_n;
	for (hl_n = 0x04C0; hl_n != 0x00; --hl_n)
	{
		*xbc_n = 0x00;
		++xbc_n;
	}
}

// 002005F5: void fn002005F5(Register word32 xwa)
void fn002005F5(word32 xwa)
{
	__ldf(0x03);
	<anonymous> *** xwa_n = DPB(xwa, w * 0x04, 8);
	word32 xsp_n;
	word16 sr_n;
	word32 xix_n;
	byte w_n;
	bool N_n;
	byte SZHVC_n;
	word32 xwa_n;
	(**xwa_n)();
}

// 0020060C: void fn0020060C()
void fn0020060C()
{
	if (*(byte *) 0x6F91 == 0x00)
	{
		*(byte *) 0x6F83 &= ~0x08;
		*(byte *) 0x6DA0 = 0x00;
	}
}

